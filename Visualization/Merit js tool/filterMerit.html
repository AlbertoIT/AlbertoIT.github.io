<!DOCTYPE html>
<html>
<head>
<script src="jquery-2.1.0.min.js"></script>
  <meta charset="utf-8">
  <title>JS Bin</title>
  <pre id="sent"></pre>
  <div id="tableSent"></div>
  <div id="tableReceived"></div>
<pre id="received"></pre>

  <script>
function loadJSON(callback) {   
  var xobj = new XMLHttpRequest();
  xobj.overrideMimeType("application/json");
  xobj.open('GET', 'content.json', true);
  xobj.onreadystatechange = function () {
    if (xobj.readyState == 4 && xobj.status == "200") {
      callback(JSON.parse(xobj.responseText));
    }
  };
  xobj.send(null);  
}

function getParameterByName(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[\[\]]/g, "\\$&");
    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, " "));
}

var result;
var userid=getParameterByName("id");
loadJSON(function(json) {
  var receivedMerit=$(json).filter(function (i,n){return n.to==userid});

var txt="";
var totalReceived=0;
var totalSent=0;
txt += "<table border='1'>"
        txt +="<tr><td colspan='3'>Received</td></tr>"
        txt +="<tr><td>From</td><td>To</td><td>Merits</td></tr>"
        for (x in receivedMerit.toArray()) {
            totalReceived+=receivedMerit[x].merit;
            txt += "<tr><td>" + receivedMerit[x].from + "</td><td>" + receivedMerit[x].to + "</td><td>" + receivedMerit[x].merit + "</td></tr>";
        }
        txt +="<tr><td colspan='3'>Total received: " + totalReceived + "</td></tr>"
        txt += "</table>"        


        document.getElementById("tableReceived").innerHTML = txt;

var sentMerit=$(json).filter(function (i,n){return n.from==userid});

txt = "<table border='1'>"
        txt +="<tr><td colspan='3'>Sent</td></tr>"
        txt +="<tr><td>From</td><td>To</td><td>Merits</td></tr>"
        for (x in sentMerit.toArray()) {
            totalSent+=sentMerit[x].merit;
            txt += "<tr><td>" + sentMerit[x].from + "</td><td>" + sentMerit[x].to + "</td><td>" + sentMerit[x].merit + "</td></tr>";
        }
        txt +="<tr><td colspan='3'>Total sent: " + totalSent + "</td></tr>"
        txt += "</table>"        


       document.getElementById("tableSent").innerHTML = txt;
});


//document.getElementById("received").innerHTML = JSON.stringify(receivedMerit.toArray(), undefined, 2);

 
</script>
</head>
<body>

</body>
</html>

